SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

CREATE SCHEMA IF NOT EXISTS providers;

SET default_tablespace = '';

CREATE TABLE providers.emitters (
    id bigint NOT NULL,
    created_at timestamp without time zone NOT NULL,
    emitter_code bigint NOT NULL,
    emitter_type character varying(50) NOT NULL,
    request_id bigint NOT NULL
);

ALTER TABLE providers.emitters ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.emitters_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.extensions (
    id bigint NOT NULL,
    name character varying(255) NOT NULL,
    type_supply_id bigint NOT NULL
);

ALTER TABLE providers.extensions ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.extensions_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.petitions (
    id bigint NOT NULL,
    created_at timestamp without time zone NOT NULL,
    justification character varying(1000),
    manager_code bigint NOT NULL,
    observations character varying(1000) NOT NULL,
    petition_state_id bigint NOT NULL,
    provider_id bigint NOT NULL
);

ALTER TABLE providers.petitions ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.petitions_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.petitions_states (
    id bigint NOT NULL,
    name character varying(255) NOT NULL
);

ALTER TABLE providers.petitions_states ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.petitions_states_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.provider_users (
    id bigint NOT NULL,
    created_at timestamp without time zone NOT NULL,
    user_code bigint NOT NULL,
    provider_id bigint NOT NULL,
    provider_profile_id bigint NOT NULL
);

ALTER TABLE providers.provider_users ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.provider_users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.providers (
    id bigint NOT NULL,
    active boolean NOT NULL,
    alias character varying(20),
    created_at timestamp without time zone NOT NULL,
    name character varying(255) NOT NULL,
    tax_identification_number character varying(255) NOT NULL,
    provider_category_id bigint NOT NULL
);

CREATE TABLE providers.providers_administrators (
    id bigint NOT NULL,
    created_at timestamp without time zone NOT NULL,
    user_code bigint NOT NULL,
    provider_id bigint NOT NULL,
    role_id bigint NOT NULL
);


ALTER TABLE providers.providers_administrators ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.providers_administrators_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


CREATE TABLE providers.providers_categorys (
    id bigint NOT NULL,
    name character varying(255) NOT NULL
);


ALTER TABLE providers.providers_categorys ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.providers_categorys_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


ALTER TABLE providers.providers ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.providers_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.providers_profiles (
    id bigint NOT NULL,
    description character varying(255),
    name character varying(255) NOT NULL,
    provider_id bigint NOT NULL
);

ALTER TABLE providers.providers_profiles ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.providers_profiles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.requests (
    id bigint NOT NULL,
    closed_at timestamp without time zone,
    closed_by bigint,
    created_at timestamp without time zone NOT NULL,
    deadline timestamp without time zone NOT NULL,
    municipality_code character varying(10) NOT NULL,
    observations character varying(255),
    package character varying(255) NOT NULL,
    sent_review_at timestamp without time zone,
    provider_id bigint NOT NULL,
    request_state_id bigint NOT NULL
);

ALTER TABLE providers.requests ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.requests_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.requests_states (
    id bigint NOT NULL,
    name character varying(255) NOT NULL
);

ALTER TABLE providers.requests_states ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.requests_states_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.roles (
    id bigint NOT NULL,
    name character varying(255) NOT NULL
);

ALTER TABLE providers.roles ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.supplies_requested (
    id bigint NOT NULL,
    created_at timestamp without time zone NOT NULL,
    delivered boolean NOT NULL,
    delivered_at timestamp without time zone,
    delivered_by bigint,
    description character varying(500),
    errors character varying(1000),
    extra_file character varying(1000),
    ftp character varying(500),
    is_valid boolean,
    justification character varying(500),
    log character varying(1000),
    model_version character varying(20),
    observations character varying(500),
    url character varying(1000),
    request_id bigint NOT NULL,
    supply_requested_state_id bigint NOT NULL,
    type_supply_id bigint NOT NULL
);

ALTER TABLE providers.supplies_requested ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.supplies_requested_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.supplies_requested_states (
    id bigint NOT NULL,
    name character varying(255) NOT NULL
);

ALTER TABLE providers.supplies_requested_states ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.supplies_requested_states_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.supplies_revisions (
    id bigint NOT NULL,
    database character varying(255) NOT NULL,
    finished_at timestamp without time zone,
    finished_by bigint,
    hostname character varying(255) NOT NULL,
    password character varying(255) NOT NULL,
    port character varying(255) NOT NULL,
    schema character varying(255) NOT NULL,
    started_at timestamp without time zone NOT NULL,
    started_by bigint NOT NULL,
    username character varying(255) NOT NULL,
    supply_requested_id bigint NOT NULL
);

ALTER TABLE providers.supplies_revisions ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.supplies_revisions_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

CREATE TABLE providers.types_supplies (
    id bigint NOT NULL,
    active boolean NOT NULL,
    created_at timestamp without time zone NOT NULL,
    description character varying(255),
    metadata_required boolean NOT NULL,
    model_required boolean NOT NULL,
    name character varying(255) NOT NULL,
    provider_id bigint NOT NULL,
    provider_profile_id bigint NOT NULL
);

ALTER TABLE providers.types_supplies ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME providers.types_supplies_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

INSERT INTO providers.extensions VALUES (1, 'xtf', 2);
INSERT INTO providers.extensions VALUES (2, 'tif', 3);
INSERT INTO providers.extensions VALUES (3, 'img', 3);
INSERT INTO providers.extensions VALUES (4, 'ecw', 3);
INSERT INTO providers.extensions VALUES (5, 'sid', 3);
INSERT INTO providers.extensions VALUES (6, 'tif', 4);
INSERT INTO providers.extensions VALUES (7, 'img', 4);
INSERT INTO providers.extensions VALUES (8, 'ecw', 4);
INSERT INTO providers.extensions VALUES (9, 'sid', 4);
INSERT INTO providers.extensions VALUES (10, 'shp', 5);
INSERT INTO providers.extensions VALUES (11, 'gpkg', 5);
INSERT INTO providers.extensions VALUES (12, 'tif', 6);
INSERT INTO providers.extensions VALUES (13, 'img', 6);
INSERT INTO providers.extensions VALUES (14, 'shp', 7);
INSERT INTO providers.extensions VALUES (15, 'gpkg', 7);
INSERT INTO providers.extensions VALUES (16, 'shp', 8);
INSERT INTO providers.extensions VALUES (17, 'gpkg', 8);
INSERT INTO providers.extensions VALUES (18, 'gdb', 9);
INSERT INTO providers.extensions VALUES (19, 'mdb', 9);
INSERT INTO providers.extensions VALUES (20, 'pdf', 9);
INSERT INTO providers.extensions VALUES (21, 'gpkg', 9);
INSERT INTO providers.extensions VALUES (22, 'shp', 10);
INSERT INTO providers.extensions VALUES (23, 'gpkg', 10);
INSERT INTO providers.extensions VALUES (24, 'xtf', 12);

INSERT INTO providers.petitions_states VALUES (1, 'PENDIENTE');
INSERT INTO providers.petitions_states VALUES (2, 'ACEPTADO');
INSERT INTO providers.petitions_states VALUES (3, 'RECHAZADO');

INSERT INTO providers.providers VALUES (1, true, 'IGAC', '2022-04-04 12:32:10.48', 'INSTITUTO GEOGRÁFICO AGUSTÍN CODAZZI', '8999990049', 1);
INSERT INTO providers.providers VALUES (8, true, 'SNR', '2022-04-04 12:32:10.582', 'SUPERINTENDENCIA DE NOTARIADO Y REGISTRO', '899999007', 2);
INSERT INTO providers.providers VALUES (9, true, 'ANT', '2022-04-04 12:32:10.591', 'AGENCIA NACIONAL DE TIERRAS', '9009489538', 3);
INSERT INTO providers.providers VALUES (10, true, 'DANE', '2022-04-04 12:32:10.594', 'DEPARTAMENTO ADMINISTRATIVO NACIONAL DE ESTADÍSTICA', '899999027', 4);

INSERT INTO providers.providers_categorys VALUES (1, 'CATASTRO');
INSERT INTO providers.providers_categorys VALUES (2, 'REGISTRO');
INSERT INTO providers.providers_categorys VALUES (3, 'TIERRAS');
INSERT INTO providers.providers_categorys VALUES (4, 'GENERAL');

INSERT INTO providers.providers_profiles VALUES (1, NULL, 'CATASTRO', 1);
INSERT INTO providers.providers_profiles VALUES (2, NULL, 'CARTOGRAFÍA', 1);
INSERT INTO providers.providers_profiles VALUES (3, NULL, 'AGROLOGÍA', 1);
INSERT INTO providers.providers_profiles VALUES (4, NULL, 'REGISTRO', 8);
INSERT INTO providers.providers_profiles VALUES (5, NULL, 'ANT', 9);

INSERT INTO providers.requests_states VALUES (1, 'SOLICITADA');
INSERT INTO providers.requests_states VALUES (2, 'ENTREGADA');
INSERT INTO providers.requests_states VALUES (3, 'CANCELADA');

INSERT INTO providers.roles VALUES (1, 'ADMINISTRADOR PROVEEDOR');
INSERT INTO providers.roles VALUES (2, 'REVISOR');

INSERT INTO providers.supplies_requested_states VALUES (1, 'ACEPTADO');
INSERT INTO providers.supplies_requested_states VALUES (2, 'RECHAZADO');
INSERT INTO providers.supplies_requested_states VALUES (3, 'VALIDANDO');
INSERT INTO providers.supplies_requested_states VALUES (4, 'PENDIENTE');
INSERT INTO providers.supplies_requested_states VALUES (5, 'NO ENTREGADO');
INSERT INTO providers.supplies_requested_states VALUES (6, 'PENDIENTE DE REVISIÓN');
INSERT INTO providers.supplies_requested_states VALUES (7, 'CONFIGURANDO REVISIÓN');
INSERT INTO providers.supplies_requested_states VALUES (8, 'EN REVISIÓN');
INSERT INTO providers.supplies_requested_states VALUES (9, 'CERRANDO REVISIÓN');

INSERT INTO providers.types_supplies VALUES (2, true, '2022-04-04 12:32:10.526', NULL, false, true, 'Bases catastrales del municipio', 1, 1);
INSERT INTO providers.types_supplies VALUES (3, true, '2022-04-04 12:32:10.534', NULL, false, false, 'Ortoimagen fuentes existentes', 1, 2);
INSERT INTO providers.types_supplies VALUES (4, true, '2022-04-04 12:32:10.543', NULL, false, false, 'Ortoimagen (insumo para catastro)', 1, 2);
INSERT INTO providers.types_supplies VALUES (5, true, '2022-04-04 12:32:10.55', NULL, false, false, 'Cartografía Básica Vectorial', 1, 2);
INSERT INTO providers.types_supplies VALUES (6, true, '2022-04-04 12:32:10.555', NULL, false, false, 'Modelo Digital de Elevación', 1, 2);
INSERT INTO providers.types_supplies VALUES (7, true, '2022-04-04 12:32:10.56', NULL, false, false, 'Límites y Fronteras', 1, 2);
INSERT INTO providers.types_supplies VALUES (8, true, '2022-04-04 12:32:10.565', NULL, false, false, 'Datos Geodésicos', 1, 2);
INSERT INTO providers.types_supplies VALUES (9, true, '2022-04-04 12:32:10.57', NULL, false, false, 'Áreas Homogéneas de Tierra', 1, 3);
INSERT INTO providers.types_supplies VALUES (10, true, '2022-04-04 12:32:10.576', NULL, false, false, 'Uso y Cobertura de la Tierra', 1, 3);
INSERT INTO providers.types_supplies VALUES (12, true, '2022-04-04 12:32:10.587', NULL, false, true, 'Datos registrales en modelo de insumos', 8, 4);

SELECT pg_catalog.setval('providers.emitters_id_seq', 1, false);
SELECT pg_catalog.setval('providers.extensions_id_seq', 24, true);
SELECT pg_catalog.setval('providers.petitions_id_seq', 1, false);
SELECT pg_catalog.setval('providers.petitions_states_id_seq', 3, true);
SELECT pg_catalog.setval('providers.provider_users_id_seq', 1, false);
SELECT pg_catalog.setval('providers.providers_administrators_id_seq', 1, false);
SELECT pg_catalog.setval('providers.providers_categorys_id_seq', 4, true);
SELECT pg_catalog.setval('providers.providers_id_seq', 10, true);
SELECT pg_catalog.setval('providers.providers_profiles_id_seq', 5, true);
SELECT pg_catalog.setval('providers.requests_id_seq', 1, false);
SELECT pg_catalog.setval('providers.requests_states_id_seq', 3, true);
SELECT pg_catalog.setval('providers.roles_id_seq', 2, true);
SELECT pg_catalog.setval('providers.supplies_requested_id_seq', 1, false);
SELECT pg_catalog.setval('providers.supplies_requested_states_id_seq', 9, true);
SELECT pg_catalog.setval('providers.supplies_revisions_id_seq', 1, false);
SELECT pg_catalog.setval('providers.types_supplies_id_seq', 12, true);

ALTER TABLE ONLY providers.emitters
    ADD CONSTRAINT emitters_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.extensions
    ADD CONSTRAINT extensions_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.petitions
    ADD CONSTRAINT petitions_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.petitions_states
    ADD CONSTRAINT petitions_states_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.provider_users
    ADD CONSTRAINT provider_users_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.providers_administrators
    ADD CONSTRAINT providers_administrators_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.providers_categorys
    ADD CONSTRAINT providers_categorys_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.providers
    ADD CONSTRAINT providers_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.providers_profiles
    ADD CONSTRAINT providers_profiles_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.requests
    ADD CONSTRAINT requests_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.requests_states
    ADD CONSTRAINT requests_states_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.roles
    ADD CONSTRAINT roles_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.supplies_requested
    ADD CONSTRAINT supplies_requested_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.supplies_requested_states
    ADD CONSTRAINT supplies_requested_states_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.supplies_revisions
    ADD CONSTRAINT supplies_revisions_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.types_supplies
    ADD CONSTRAINT types_supplies_pkey PRIMARY KEY (id);

ALTER TABLE ONLY providers.types_supplies
    ADD CONSTRAINT fk2kah37qobcueele652mldp1s0 FOREIGN KEY (provider_profile_id) REFERENCES providers.providers_profiles(id);

ALTER TABLE ONLY providers.extensions
    ADD CONSTRAINT fk3phi493nkheb6gusv6xahl3wc FOREIGN KEY (type_supply_id) REFERENCES providers.types_supplies(id);

ALTER TABLE ONLY providers.providers_administrators
    ADD CONSTRAINT fk4npmxi6om4uqo8crueqctg7c3 FOREIGN KEY (provider_id) REFERENCES providers.providers(id);

ALTER TABLE ONLY providers.types_supplies
    ADD CONSTRAINT fk7eigs2yri0t5nlyfcwtba48m6 FOREIGN KEY (provider_id) REFERENCES providers.providers(id);

ALTER TABLE ONLY providers.requests
    ADD CONSTRAINT fk7qd2v6ucrur3ikrpg93keukkq FOREIGN KEY (request_state_id) REFERENCES providers.requests_states(id);

ALTER TABLE ONLY providers.providers_administrators
    ADD CONSTRAINT fk8wl0kburqyhmd7o19pkpjfyta FOREIGN KEY (role_id) REFERENCES providers.roles(id);

ALTER TABLE ONLY providers.supplies_revisions
    ADD CONSTRAINT fk9cnls53rx5whu8iax58lxdqkh FOREIGN KEY (supply_requested_id) REFERENCES providers.supplies_requested(id);

ALTER TABLE ONLY providers.petitions
    ADD CONSTRAINT fkb22kdq9y08a67r0kq76ugwg7e FOREIGN KEY (provider_id) REFERENCES providers.providers(id);

ALTER TABLE ONLY providers.provider_users
    ADD CONSTRAINT fkbwxypbaus35obyyfvvtpyh38m FOREIGN KEY (provider_id) REFERENCES providers.providers(id);

ALTER TABLE ONLY providers.supplies_requested
    ADD CONSTRAINT fkeya9h3qxnd820lw6e8nxpv99j FOREIGN KEY (type_supply_id) REFERENCES providers.types_supplies(id);

ALTER TABLE ONLY providers.providers
    ADD CONSTRAINT fkfbgki3lhlfb59ap9n6q1fn8s FOREIGN KEY (provider_category_id) REFERENCES providers.providers_categorys(id);

ALTER TABLE ONLY providers.provider_users
    ADD CONSTRAINT fkhip63a0lquv8o10uncw4k33ob FOREIGN KEY (provider_profile_id) REFERENCES providers.providers_profiles(id);

ALTER TABLE ONLY providers.providers_profiles
    ADD CONSTRAINT fkjyxjuknun276h64rbwftk78xh FOREIGN KEY (provider_id) REFERENCES providers.providers(id);

ALTER TABLE ONLY providers.supplies_requested
    ADD CONSTRAINT fklmxactu5f80yek0k9vw4a2u76 FOREIGN KEY (request_id) REFERENCES providers.requests(id);

ALTER TABLE ONLY providers.petitions
    ADD CONSTRAINT fkp9sx4j45sx45468kj1s26f3c1 FOREIGN KEY (petition_state_id) REFERENCES providers.petitions_states(id);

ALTER TABLE ONLY providers.supplies_requested
    ADD CONSTRAINT fkpokxy510ki21ss9uk54qrdivq FOREIGN KEY (supply_requested_state_id) REFERENCES providers.supplies_requested_states(id);

ALTER TABLE ONLY providers.emitters
    ADD CONSTRAINT fksd916f3f9bmujkq70cmakldk9 FOREIGN KEY (request_id) REFERENCES providers.requests(id);

ALTER TABLE ONLY providers.requests
    ADD CONSTRAINT fksn5i4qvallc9blwf6f5ixoidf FOREIGN KEY (provider_id) REFERENCES providers.providers(id);